{"version":3,"sources":["webpack:///./src/views/articles/Create.vue?b53d","webpack:///./src/views/articles/Create.vue?294b","webpack:///src/views/articles/Create.vue","webpack:///./src/views/articles/Create.vue?ae14","webpack:///./src/views/articles/Create.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","articleId","attrs","directives","name","rawName","value","expression","modifiers","title","domProps","on","$event","target","composing","trim","saveTitle","$forceUpdate","_m","post","staticRenderFns","window","hljs","data","content","undefined","beforeRouteEnter","next","beforeRouteLeave","clearData","watch","mounted","element","document","querySelector","placeholder","spellChecker","autoDownloadFontAwesome","autosave","renderingConfig","codeSyntaxHighlighting","simplemde","codemirror","methods","fillContent","smde_title","$store","dispatch","clearAutosavedValue","setArticleId","component"],"mappings":"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","file":"js/chunk-2733de13.12e2789e.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=style&index=0&id=79b731ed&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"blog-container\"},[_c('div',{staticClass:\"blog-pages\"},[_c('div',{staticClass:\"col-md-12 panel\"},[_c('div',{staticClass:\"panel-body\"},[_c('h2',{staticClass:\"text-center\"},[_vm._v(_vm._s(_vm.articleId ? '编辑文章':'创作文章'))]),_c('hr'),_c('div',{attrs:{\"data-validator-form\":\"\"}},[_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.title),expression:\"title\",modifiers:{\"trim\":true}},{name:\"validator\",rawName:\"v-validator.required\",value:({ title: '标题' }),expression:\"{ title: '标题' }\",modifiers:{\"required\":true}}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"请填写标题\"},domProps:{\"value\":(_vm.title)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.title=$event.target.value.trim()},_vm.saveTitle],\"blur\":function($event){return _vm.$forceUpdate()}}})]),_vm._m(0),_c('br'),_c('div',{staticClass:\"form-group\",on:{\"click\":_vm.post}},[_c('button',{staticClass:\"btn btn-primary\",attrs:{\"type\":\"submit\"}},[_vm._v(\"发 布\")])])])])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"form-group\"},[_c('textarea',{attrs:{\"id\":\"editor\"}})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"blog-container\">\r\n    <div class=\"blog-pages\">\r\n      <div class=\"col-md-12 panel\">\r\n        <div class=\"panel-body\">\r\n          <h2 class=\"text-center\">{{ articleId ? '编辑文章':'创作文章' }}</h2>\r\n          <hr>\r\n          <div data-validator-form>\r\n            <div class=\"form-group\">\r\n              <input v-model.trim=\"title\" v-validator.required=\"{ title: '标题' }\" type=\"text\" class=\"form-control\" placeholder=\"请填写标题\" @input=\"saveTitle\">\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <!-- <textarea v-validator.required=\"{ title: '内容' }\" class=\"form-control\" placeholder=\"请使用 Markdown 格式书写 ;-)，代码片段黏贴时请注意使用高亮语法。\"></textarea> -->\r\n              <textarea id=\"editor\"></textarea>\r\n            </div>\r\n            <br>\r\n            <div class=\"form-group\" @click=\"post\">\r\n              <button class=\"btn btn-primary\" type=\"submit\">发 布</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SimpleMDE from 'simplemde'\r\nimport hljs from 'highlight.js'\r\nimport ls from '@/utils/localStorage'\r\n\r\n// 添加全局变量\r\nwindow.hljs = hljs\r\n\r\nexport default {\r\n  name: 'Create',\r\n  // 添加相关数据\r\n  data() {\r\n    return {\r\n      title: '', // 文章标题\r\n      content: '', // 文章内容\r\n      articleId: undefined // 文章 ID\r\n    }\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    // 确认渲染组件的对应路由时，设置 articleId\r\n    next(vm => {\r\n        // 让 mounted 先执行\r\n        vm.$nextTick().then(() => { \r\n            vm.setArticleId(vm.$route.params.articleId)\r\n        })\r\n    })\r\n    // next(vm => {\r\n    //     // 确认渲染组件的对应路由时，设置 articleId\r\n    //     vm.setArticleId(vm.$route.params.articleId)\r\n    // })\r\n  },\r\n  // 在离开该组件的对应路由前 beforeRouteLeave 是组件内的守卫，在离开该组件的对应路由时调用，此时可以访问 this，需要使用 next() 确认导航\r\n  beforeRouteLeave(to, from, next) {\r\n    // 清空自动保存的文章数据\r\n    this.clearData()\r\n    next()\r\n  },\r\n  watch: {\r\n    // 监听路由参数的变化 \r\n    // 以通过监听 '$route' 来得知路由参数的变化，我们通常会在两个路由都渲染相同的组件时监听 '$route'，这是因为 Vue 会复用组件实例，以导致组件内的部分钩子不再被调用。举例来说，我们的『编辑文章』和 『创作文章』都使用 Create.vue 组件，当我们从『编辑文章』导航到『创作文章』时（在编辑文章页面点击创作文章按钮），beforeRouteEnter 就不会被调用，所以我们需要监听 '$route'，以响应路由参数的变化\r\n    '$route'(to) {\r\n        // 清空自动保存的文章数据\r\n        this.clearData()\r\n        // 设置 articleId\r\n        this.setArticleId(to.params.articleId)\r\n    }\r\n  },\r\n  // mounted 钩子在元素挂载到实例之后调用，此时我们能访当前组件的元素，进而为编辑器指定一个绑定元素\r\n  mounted() {\r\n    // 创建一个 SimpleMDE 的实例\r\n    const simplemde = new SimpleMDE({\r\n      // 要绑定的 textarea 元素  \r\n      element: document.querySelector('#editor'),\r\n      // 占位符\r\n      placeholder: '请使用 Markdown 格式书写 ;-)，代码片段黏贴时请注意使用高亮语法。',\r\n      // 禁用拼写检查\r\n      spellChecker: false,\r\n      // 不用自动下载 FontAwesome，因为我们刚好有使用 FontAwesome，所以不用自动下载\r\n      autoDownloadFontAwesome: false,\r\n      // 启用自动保存，uniqueId 是一个用于区别于其他站点的标识\r\n      autosave: {\r\n          enabled: true,\r\n          uniqueId: 'vuejs-essential'\r\n      },\r\n      // 启用代码高亮，需要引入 highlight.js\r\n      renderingConfig: {\r\n        codeSyntaxHighlighting: true\r\n      }\r\n    })\r\n\r\n    // 监听编辑器的 change 事件\r\n    simplemde.codemirror.on('change', () => {\r\n      // 将改变后的值赋给文章内容\r\n      this.content = simplemde.value()\r\n    })\r\n\r\n    // 将 simplemde 添加到当前实例，以在其他地方调用\r\n    this.simplemde = simplemde\r\n    // 初始化标题和内容\r\n    // this.fillContent()\r\n\r\n  },\r\n  methods: {\r\n    // 编辑器只会自动保存文章的内容，我们需要自己保存文章的标题\r\n    saveTitle() {\r\n      ls.setItem('smde_title', this.title)\r\n    },\r\n\r\n    // 初始化标题和内容 填充文章数据\r\n    fillContent(articleId) {\r\n      const simplemde = this.simplemde\r\n      // 自动保存的标题\r\n      const smde_title  = ls.getItem('smde_title')\r\n\r\n      // 有文章Id\r\n      if(articleId != undefined) {\r\n        // 根据id 获取文章\r\n        const article = this.$store.getters.getArticleById(articleId)\r\n\r\n        if(article) {\r\n          const { title, content } = article\r\n\r\n          // 如果有自动保存的标题 和 内容 否则取存储中的标题和内容\r\n          this.title = smde_title || title\r\n          this.content = simplemde.value() || content\r\n\r\n          // 设置编辑器内容\r\n          simplemde.value(this.content)\r\n        }\r\n      }else { // 没有articleId 时 使用自动保存的内容\r\n        this.title = smde_title\r\n        // 使用编辑器的内容作为文章内容\r\n        this.content = simplemde.value()\r\n      }\r\n    },\r\n\r\n    // 发布\r\n    post() {\r\n      const title = this.title\r\n      const content = this.content\r\n\r\n      // 如果标题和内容都不为空，提交发布\r\n      if (title !== '' && content.trim() !== '') {\r\n        const article = {\r\n          title,\r\n          content\r\n        }\r\n\r\n        // 在控制台输出当前文章\r\n        // console.log(article)\r\n        // 分发更新保存文章事件 携带articleId\r\n        this.$store.dispatch('post', { article, articleId: this.articleId })\r\n\r\n        // 清除数据\r\n        this.clearData()\r\n      }\r\n    },\r\n    // 清除数据\r\n    clearData() {\r\n      this.title = ''\r\n      ls.removeItem('smde_title')\r\n      // 清除编辑的内容\r\n      this.simplemde.value('')\r\n      // 清除编辑器自动保存的内容\r\n      this.simplemde.clearAutosavedValue()\r\n    },\r\n    // 设置articleId\r\n    setArticleId(articleId) {\r\n      // 获取当前存储的文章id ，用来判断编辑页面文章与请求文章是否相同\r\n      const localArticleId = ls.getItem('articleId')\r\n\r\n      // 文章不相同且存在时 清除数据\r\n      if(articleId !== undefined && !(articleId === localArticleId)) {\r\n        this.clearData()\r\n      }\r\n\r\n      // 设置当前文章id\r\n      this.articleId = articleId\r\n\r\n      // 填充文章数据\r\n      this.fillContent(articleId)\r\n\r\n      // 存入当前文章id\r\n      ls.setItem('articleId',articleId)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.blog-container { max-width: 980px; margin: 0 auto; margin-top: 20px;}\r\ntextarea { height: 200px; }\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Create.vue?vue&type=template&id=79b731ed&scoped=true&\"\nimport script from \"./Create.vue?vue&type=script&lang=js&\"\nexport * from \"./Create.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Create.vue?vue&type=style&index=0&id=79b731ed&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"79b731ed\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}